<div class="metis-form metis-form-horizontal">

  <form [formGroup]="workflowForm" #formDir="ngForm">
      
    <div class="messages" (clickOutside)="onClickedOutside()">
      <div class="error-message" *ngIf="errorMessage">{{errorMessage}}</div>
      <div class="success-message" *ngIf="successMessage">{{successMessage}}</div>
    </div>

    <div class="predefined-workflows">
      <ul class="predefined-workflows-tabs">
        <li [ngClass]="{'active': !selectedPredefinedWorkflow}" (click)="selectPredefinedWorkflow()">Current</li>
        <li [ngClass]="{'active': selectedPredefinedWorkflow === 'basic'}" (click)="selectPredefinedWorkflow('basic')">Basic</li>
        <li [ngClass]="{'active': selectedPredefinedWorkflow === 'everything'}" (click)="selectPredefinedWorkflow('everything')">Run everything</li>
      </ul>
      <ul class="predefined-steps">
        <li [ngClass]="{'inactive': workflowForm.get('pluginHARVEST').value === false || workflowForm.get('pluginHARVEST').value === ''}">
          <a [routerLink]="[currentUrl]" fragment="harvest">{{ 'import' | translate }}</a></li>
        <li [ngClass]="{'inactive': workflowForm.get('pluginVALIDATION_EXTERNAL').value === false || workflowForm.get('pluginVALIDATION_EXTERNAL').value === ''}">
          <a [routerLink]="[currentUrl]" fragment="validation-external">{{ 'validation external' | translate }}</a>
        </li>
        <li [ngClass]="{'inactive': workflowForm.get('pluginTRANSFORMATION').value === false || workflowForm.get('pluginTRANSFORMATION').value === ''}">
          <a [routerLink]="[currentUrl]" fragment="transformation">{{ 'transformation' | translate }}</a>
        </li>
        <li [ngClass]="{'inactive': workflowForm.get('pluginVALIDATION_INTERNAL').value === false || workflowForm.get('pluginVALIDATION_INTERNAL').value === ''}">
          <a [routerLink]="[currentUrl]" fragment="validation-internal">{{ 'validation internal' | translate }}</a>
        </li>
        <li [ngClass]="{'inactive': workflowForm.get('pluginENRICHMENT').value === false || workflowForm.get('pluginENRICHMENT').value === ''}">
          <a [routerLink]="[currentUrl]" fragment="enrichment">{{ 'enrichment' | translate }}</a>
        </li>
        <li [ngClass]="{'inactive': workflowForm.get('pluginMEDIA_PROCESS').value === false || workflowForm.get('pluginMEDIA_PROCESS').value === ''}">
          <a [routerLink]="[currentUrl]" fragment="enrichment">{{ 'mediaservice' | translate }}</a>
        </li>
      </ul>
    </div>

    <div class="form-fields-container">
      <!-- IMPORT / HARVEST -->
      <div id="harvest" class="form-fields" [ngClass]="{'inactive': workflowForm.get('pluginHARVEST').value === false || workflowForm.get('pluginHARVEST').value === ''}">      
        <label for="pluginImport" class="plugin">{{ 'import' | translate }} <input type="checkbox" formControlName="pluginHARVEST" id="pluginImport" /></label>    
        <div class="form-group">
          <label>{{ 'harvestprotocol' | translate }} *</label>
          <div class="form-group-radios">
            <div>
              <label>
                <input type="radio" formControlName="pluginType" value="OAIPMH_HARVEST" [(ngModel)]="harvestprotocol" [checked]="harvestprotocol === 'OAIPMH_HARVEST' ? true : false" /> {{ 'oai' | translate }}
              </label>
            </div>   
            <div>
              <label>
                <input type="radio" formControlName="pluginType" value="HTTP_HARVEST" [(ngModel)]="harvestprotocol" [checked]="harvestprotocol === 'HTTP_HARVEST' ? true : false" />
                {{ 'http' | translate }}
              </label>
            </div>          
          </div>
        </div>
        <div class="form-group" *ngIf="harvestprotocol === 'OAIPMH_HARVEST'">
          <label for="harvest-url">{{ 'harvesturl' | translate }} *</label>
          <input id="harvest-url" type="text" formControlName="harvestUrl" />
        </div>
        <div class="form-group" *ngIf="harvestprotocol === 'OAIPMH_HARVEST'">
          <label for="setspec">{{ 'setspec' | translate }}</label>
          <input id="setspec" type="tel" formControlName="setSpec" />
        </div>
        <div class="form-group" *ngIf="harvestprotocol === 'OAIPMH_HARVEST'">
          <label for="metadata-format">{{ 'metadataformat' | translate }} *</label>
          <input id="metadata-format" type="text" formControlName="metadataFormat" />
        </div>      
        <div class="form-group" *ngIf="harvestprotocol === 'HTTP_HARVEST'">
          <label for="url">{{ 'url' | translate }} *</label>
          <input id="url" type="text" formControlName="url" />
        </div>
      </div>

      <!-- VALIDATION -->
      <div id="validation-external" class="form-fields" [ngClass]="{'inactive': workflowForm.get('pluginVALIDATION_EXTERNAL').value === false || workflowForm.get('pluginVALIDATION_EXTERNAL').value === ''}"> 
        <label for="pluginValidateExternal" class="plugin">{{ 'validation external' | translate }}<input type="checkbox" formControlName="pluginVALIDATION_EXTERNAL" id="pluginValidateExternal" /></label>
      </div>

      <!-- TRANSFORMATION -->
      <div id="transformation" class="form-fields" [ngClass]="{'inactive': workflowForm.get('pluginTRANSFORMATION').value === false || workflowForm.get('pluginTRANSFORMATION').value === ''}"> 
        <label for="pluginTransform" class="plugin">{{ 'transformation' | translate }} <input type="checkbox" formControlName="pluginTRANSFORMATION" id="pluginTransform" /></label>
        <div class="form-group">
          <label for="customxslt">{{ 'customxslt' | translate }}</label>
          <input id="customxslt" type="checkbox" formControlName="customxslt" />
        </div>
      </div>

      <!-- VALIDATION -->
      <div id="validation-internal" class="form-fields" [ngClass]="{'inactive': workflowForm.get('pluginVALIDATION_INTERNAL').value === false || workflowForm.get('pluginVALIDATION_INTERNAL').value === ''}"> 
        <label for="pluginValidateInternal" class="plugin">{{ 'validation internal' | translate }}<input type="checkbox" formControlName="pluginVALIDATION_INTERNAL" id="pluginValidateInternal" /></label>
      </div>

      <!-- ENRICHMENT -->
      <div id="enrichment" class="form-fields" [ngClass]="{'inactive': workflowForm.get('pluginENRICHMENT').value === false || workflowForm.get('pluginENRICHMENT').value === ''}"> 
        <label for="pluginEnrichment" class="plugin">{{ 'enrichment' | translate }} <input type="checkbox" formControlName="pluginENRICHMENT" id="pluginEnrichment" /></label>
      </div>

      <!-- MEDIA SERVICE -->
      <div id="mediaservice" class="form-fields" [ngClass]="{'inactive': workflowForm.get('pluginMEDIA_PROCESS').value === false || workflowForm.get('pluginMEDIA_PROCESS').value === ''}"> 
        <label for="pluginMEDIA_PROCESS" class="plugin">{{ 'mediaservice' | translate }} <input type="checkbox" formControlName="pluginMEDIA_PROCESS" id="pluginMEDIA_PROCESS" /></label>
      </div>

      <div class="form-fields form-fields-buttons">  
        <div class="form-group form-group-btns user-profile-edit-btns">
          <button class="submit" type="button" (click)="onSubmit()" [disabled]="!workflowForm.valid || !selectedSteps">{{ 'submit' | translate }}</button>
        </div>
      </div>
    </div>
    
  </form>
</div>
