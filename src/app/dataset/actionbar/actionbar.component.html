<div class="messages">
  <div class="error-message" *ngIf="errorMessage"><i class="fa fa-times"></i>{{errorMessage}}</div>
</div>

<div class="metis-dataset-info-block dataset-actionbar" *ngIf=currentWorkflow>
	<div class="status">
    <strong>{{currentWorkflowName}}</strong>
    {{currentStatus}}
  </div>
  <div class="progress">
    <div class="progress-status" *ngIf="currentStatus === 'RUNNING' || currentStatus === 'INQUEUE'">
      <span class="progress-statusnumbers">{{totalProcessed}} / {{totalInDataset}}</span>
      <span class="progress-percentage">{{workflowPercentage | number:'1.0-0' }}%</span>
    </div>
    <div class="progressbar" *ngIf="currentStatus === 'RUNNING' || currentStatus === 'INQUEUE'">
      <div class="progressbar-done" [style.width.%]="workflowPercentage >= 0 ? workflowPercentage : 0"></div>
    </div>
  </div>
  <div class="datetime"><span class="date">{{now | date:'dd/MM/yyyy'}}</span> <span class="datedivider">-</span> <span class="time">{{now | date:'HH:mm'}}</span></div>
  <nav>
		<ul>
      <li *ngIf="currentStatus === 'RUNNING' || currentStatus === 'INQUEUE'">
        <a class="cancel-btn svg-icon-cancel tooltip" attr.data-tooltip="{{ 'cancel' | translate }}" (click)="cancelWorkflow()"><span>{{ 'cancel' | translate }}</span></a>
      </li>
			<li>
        <a class="log-btn svg-icon-log tooltip" attr.data-tooltip="{{ 'log' | translate }}" (click)="showLog()" *ngIf="currentStatus !== 'INQUEUE'"><span>{{ 'log' | translate }}</span></a>
      </li> 
      <li *ngIf="currentStatus === 'CANCELLED' || currentStatus === 'FINISHED' || currentStatus === 'FAILED'" (clickOutside)="onClickedOutsideWorkflow($event)">
        <a class="newaction-btn svg-icon-selector" (click)="openWorkflowSelector()" [ngClass]="{'newaction-btn-open': isShowingWorkflowSelector===true}">
            <span>{{ 'next action' | translate }}</span>
        </a>
        <ul class="workflow-selector" *ngIf="isShowingWorkflowSelector">
          <li *ngFor="let w of allWorkflows;"><a (click)="selectWorkflow(w)">{{w}}</a></li>
          <li><a (click)="selectWorkflow('transformation_enforce_oaipmh')">transformation_enforce_oaipmh</a></li>
        </ul>
      </li> 
		</ul>
	</nav>
</div>

<div class="metis-dataset-info-block dataset-actionbar" *ngIf=!currentWorkflow>
  <div class="status status-new">
    {{ 'start workflow' | translate }}
  </div>
  <nav>
    <ul>
      <li>
        <a class="newaction-btn svg-icon-selector" (click)="openWorkflowSelector()" (clickOutside)="onClickedOutsideWorkflow($event)" [ngClass]="{'newaction-btn-open': isShowingWorkflowSelector===true}">
          <span>{{ 'next action' | translate }}</span>
        </a>
        <ul *ngIf="isShowingWorkflowSelector">
          <li *ngFor="let w of allWorkflows;"><a (click)="selectWorkflow(w)">{{w}}</a></li>
          <li><a (click)="selectWorkflow('transformation_enforce_oaipmh')">transformation_enforce_oaipmh</a></li>
        </ul>
      </li>   
    </ul>
  </nav>
</div>